# Robust backend-only configuration for Railway
# This only builds and deploys the Python FastAPI backend

[phases.setup]
nixPkgs = ["python311"]

[phases.install]
cmds = [
    "cd backend && python -m pip install --upgrade pip",
    "cd backend && python -m pip install --no-cache-dir fastapi==0.104.1 uvicorn[standard]==0.24.0",
    "cd backend && python -m pip install --no-cache-dir sqlalchemy==2.0.23 pymysql==1.1.0",
    "cd backend && python -m pip install --no-cache-dir python-multipart==0.0.6 python-dotenv==1.0.0",
    "cd backend && python -m pip install --no-cache-dir openai==1.3.7 alembic==1.12.1 requests==2.31.0",
    "cd backend && python -m pip install --no-cache-dir python-jose[cryptography]==3.3.0 passlib[bcrypt]==1.7.4",
    "cd backend && python -m pip install --no-cache-dir email-validator==2.1.0 reportlab==4.0.7 PyPDF2==3.0.1",
    "cd backend && python -m pip install --no-cache-dir scikit-learn==1.3.2 numpy==1.24.3"
]

[start]
cmd = "cd backend && uvicorn main:app --host 0.0.0.0 --port $PORT"